CREATE DATABASE MYACCOUNT;
USE MYACCOUNT;
CREATE TABLE BRANCH(
BNAME VARCHAR(20) PRIMARY KEY,
CITY VARCHAR(30) NOT NULL );

alter table BRANCH  modify CITY  Varchar(30) check( CITY in ( "NAGPUR", "DELHI"," BANGALORE","BOMBAY"));

create table CUSTOMER
(CNAME VARCHAR(15) PRIMARY KEY ,
CITY VARCHAR(20) NOT NULL );
CREATE TABLE BORROW (LOANNO VARCHAR(8) CHECK (LOANNO LIKE 'L%') PRIMARY KEY,CNAME
VARCHAR(15)	REFERENCES	CUSTOMER(CNAME)	,BNAME 	VARCHAR(20) REFERENCES
BRANCH(BNAME),AMOUNT FLOAT(8) CHECK (AMOUNT>0) NOT NULL);

CREATE TABLE DEPOSIT (ACTNO VARCHAR(5) CHECK (ACTNO LIKE 'D%') PRIMARY KEY ,CNAME
VARCHAR(15)	REFERENCES	CUSTOMER(CNAME)	,BNAME 	VARCHAR(20) REFERENCES
BRANCH(BNAME),AMOUNT FLOAT(8) CHECK (AMOUNT>0) NOT NULL, ADATE varchar(30));
drop table  DEPOSIT;

INSERT INTO CUSTOMER VALUES('ANIL','CALCUTTA'); 
INSERT INTO CUSTOMER VALUES('SUNIL','DELHI');
 INSERT INTO CUSTOMER VALUES('MEHUL','BARODA');
 INSERT INTO CUSTOMER VALUES('MANDAR','PATNA');
 INSERT INTO CUSTOMER VALUES('MADHURI','NAGPUR'); 
 INSERT INTO CUSTOMER VALUES('PRAMOD', 'NAGPUR'); 
 INSERT INTO CUSTOMER VALUES('SANDIP','SURAT');
 INSERT INTO CUSTOMER VALUES('SHIVANI','BOMBAY'); 
INSERT INTO CUSTOMER VALUES('KRANTI','BOMBAY'); 
INSERT INTO CUSTOMER VALUES('NAREN','BOMBAY'); 
 INSERT INTO BRANCH VALUES('VRCE','NAGPUR'); 
 INSERT INTO BRANCH VALUES('AJNI','NAGPUR');
INSERT INTO BRANCH VALUES('KAROLBAGH','DELHI');
 INSERT INTO BRANCH VALUES('CHANDNI','DELHI'); 
 INSERT INTO BRANCH VALUES('DHARAMPETH','NAGPUR');
 INSERT INTO BRANCH VALUES('MG ROAD','BANGALORE'); 
 INSERT INTO BRANCH VALUES('ANDHERI','BOMBAY');
 INSERT INTO BRANCH VALUES('NEHRU PALACE','DELHI');
 INSERT INTO BRANCH VALUES('POWAI','BOMBAY');
INSERT INTO DEPOSIT VALUES('D100','ANIL','VRCE',1000.00,'1-MAR-95');
 INSERT INTO DEPOSIT VALUES('D101','SUNIL','ANJNI',500.00,'4-JAN-96');

INSERT INTO DEPOSIT VALUES('D102','MEHUL','KAROLBAGH',3500.00,'17-NOV- 95');
INSERT INTO DEPOSIT VALUES('D104','MADHURI','CHANDNI',1200.00,'17-DEC-95');
 INSERT INTO DEPOSIT VALUES('D105','PRAMOD','MG ROAD',3000.00,'27-MAR-96');
 INSERT INTO DEPOSIT VALUES('D106','SANDIP','ANDHERI',2000.00,'31-MAR-96');
 INSERT INTO DEPOSIT VALUES('D107','SHIVANI','VIRAR',1000.00,'5-SEP-95');
INSERT INTO DEPOSIT VALUES('D108','KRANTI','NEHRU PLACE',5000.00,'2-JUL- 95');
INSERT INTO DEPOSIT VALUES('D109','MINU','POWAI',7000.00,'10-AUG-95'); 
INSERT INTO BORROW VALUES('L201','ANIL','VRCE',1000.00);
INSERT INTO BORROW VALUES('L206','MEHUL','AJNI',5000.00);
INSERT INTO BORROW VALUES('L311','SUNIL','DHARAMPETH',3000.00); 
INSERT INTO BORROW VALUES('L321','MADHURI','ANDHERI',2000.00);
 INSERT INTO BORROW VALUES('L371','PRAMOD','VIRAR',8000.00); 
 INSERT INTO BORROW VALUES('L481','KRANTI','NEHRU PLACE',3000.00);

drop table DEPOSIT;
DRop table BORROW;
Drop  table customer;
SELECT D1.CNAME,D1.BNAME,C1.CNAME,C1.CITY,B1.CITY,B1.BNAME
FROM DEPOSIT D1,CUSTOMER C1,BRANCH B1 WHERE C1.CITY = 'BOMBAY' AND
B1.CITY = 'NAGPUR' AND D1.CNAME = C1.CNAME AND D1.BNAME = B1.BNAME;
SELECT distinct(customer.CNAME), BRANCH.CITY FROM BRANCH, customer
WHERE BRANCH.city = customer.city;
SELECT C1.CNAME FROM CUSTOMER C1,DEPOSIT D1,BORROW B1 WHERE
C1.CITY='NAGPUR' AND C1.CNAME=D1.CNAME AND D1.CNAME = B1.CNAME;
SELECT BR1.CNAME, BR1.AMOUNT, D1.CNAME, D1.AMOUNT FROM
BORROW BR1,DEPOSIT D1 WHERE D1.CNAME = BR1.CNAME AND D1.AMOUNT >
1000 AND BR1.AMOUNT > 2000;
SELECT D1.CNAME FROM DEPOSIT D1 WHERE D1.BNAME IN (SELECT
D2.BNAME FROM DEPOSIT D2 WHERE D2.CNAME = 'SUNIL');
SELECT BR1.CNAME,BR1.AMOUNT FROM BORROW BR1 WHERE
BR1.AMOUNT > ALL (SELECT BR2.AMOUNT FROM BORROW BR2 WHERE
BR2.CNAME = 'PRAMOD');
SELECT C.CNAME FROM CUSTOMER C WHERE C.CITY IN (SELECT B.CITY
FROM BRANCH B WHERE B.BNAME IN (SELECT D.BNAME FROM DEPOSIT D
WHERE D.CNAME='SUNIL'));
SELECT B1.CITY , C1.CITY FROM BRANCH B1,CUSTOMER C1, DEPOSIT D1
WHERE C1.CNAME = 'PRAMOD' AND C1.CNAME = D1.CNAME AND D1.BNAME =
B1.BNAME;
SELECT B1.CITY FROM DEPOSIT D1, BRANCH B1 WHERE D1.BNAME =
B1.BNAME AND D1.CNAME IN ('SUNIL' ,'ANIL');
 SELECT C1.CNAME, C1.CITY FROM CUSTOMER C1 WHERE C1.CNAME =
'ANIL' OR C1.CNAME = 'SUNIL';
SELECT D.BNAME FROM DEPOSIT D, BRANCH B ,Customer C WHERE
D.BNAME=B.BNAME  and C.city="Bombay" GROUP BY D.BNAME HAVING SUM(D.AMOUNT)>500 ; 

 select CNAME from deposit where AMOUNT=(select AVG(Amount) from DEPOSIT
GROUP BY BNAME having AVG(Amount)>5000);
SELECT MAX(AMOUNT),CNAME FROM deposit;

select count(deposit.cname)from deposit,CUSTOMER where
CUSTOMER.CITY='nagpur';
 Select CNAME from deposit where BNAME='VRCE' and amount=(select
max(AMOUNT) from deposit where BNAME='VRCE');
SELECT BNAME from deposit GROUP BY BNAME HAVING
COUNT(BNAME)>5;

select C.CNAME ,count(B.BNAME) from CUSTOMER C inner join Branch B on
C.CNAME=B.BNAME group by C.Cname order by count(B.BName) DESC;
 select count(b1.bname) From deposit d1 , borrow b1 , customer c1 Where
c1.cname=d1.cname and d1.cname=b1.cname and c1.city in (select city from customer);




 







